/*!watched.js 0.1.0 - (c) 2014 Andreas Wehr - https://github.com/grmlin/watched - Licensed under MIT license*/!function(t,e){"function"==typeof define&&define.amd?define([],function(){return t.watched=e()}):t.watched=e()}(this,function(){"use strict";var t;t={convert:function(t,e){return e={},t.on=function(n,r){return(e[n]||(e[n]=[])).push(r),t},t.once=function(e,n){function r(){n.apply(t.off(e,r),arguments)}return r.h=n,t.on(e,r)},t.off=function(n,r){for(var i=e[n],u=0;r&&i&&i[u];u++)i[u]!=r&&i[u].h!=r||i.splice(u--,1);return u||delete e[n],t},t.emit=function(n){for(var r=e[n],i=0;r&&r[i];)r[i++].apply(t,r.slice.call(arguments,1));return t},t}};var e=!0,n=!1,r="function",i="string",u=20,o=500,c=-1,s=1,a="added",l="removed",f="changed",h="querySelectorAll",v="querySelector",d="getElementsByTagName",_="getElementsByClassName",p=[h,v,d,_],y=document,m=!!(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver),b=m?MutationObserver||WebKitMutationObserver||MozMutationObserver:null,g=function(t){return p.some(function(e){return typeof t[e]!==r})},w=function(t){return Array.prototype.slice.call(t)},M=function(t,e){return e.indexOf(t)!==c},A=function(t){return t.slice(0)},E=function(t,e,n){var r;return function(){var i=this,u=arguments;clearTimeout(r),r=setTimeout(function(){r=null,n||t.apply(i,u)},e),n&&!r&&t.apply(i,u)}},O=function(){var n=y.getElementsByTagName("*"),r=function(){return w(n)},i=function(t,n){return t.length!==n.length?e:t.some(function(t,e){return t!==n[e]})},u=function(){t.convert(this),this._currentElements=r(),this._initialize()};return Object.defineProperties(u.prototype,{_initialize:{value:function(){var t=this,e=function(){setTimeout(n,o)},n=function(){t._checkDom(),e()};e()}},_checkDom:{value:function(){var t=r();i(this._currentElements,t)&&(this._currentElements=t,this.emit(s))}}}),u}(),q=function(){var n={childList:e,subtree:e},r=function(t){return null!==t.addedNodes||null!==t.removedNodes},i=function(){t.convert(this),this._observer=new b(this._onMutation.bind(this)),this._observer.observe(y,n)};return Object.defineProperties(i.prototype,{_onMutation:{value:E(function(t){t.some(r,this)&&this.emit(s)},u)}}),i}(),T=function(){var t={};return t[h]=function(t,e){return function(){var n=t[h](e);return w(n)}},t[v]=function(t,e){return function(){var n=t[v](e);return null===n?[]:[n]}},t[d]=function(t,e){var n=t[d](e);return function(){return w(n)}},t[_]=function(t,e){var n=t[_](e);return function(){return w(n)}},{create:function(e,n,r){return t[e](n,r)}}}(),j=function(t){this._query=t,this._old=[]};Object.defineProperties(j.prototype,{old:{value:function(){return A(this._old)}},current:{value:function(){return this._old=this._query(),A(this._old)}}});var N=function(t){if(g(t))throw new TypeError("changed.js: the element to watch has to be a HTMLElement!");this._el=t};p.forEach(function(t){Object.defineProperty(N.prototype,t,{value:function(e){var n=T.create(t,this._el,e),r=new j(n);return new P(r)}})});var P=function(){var r=new(m?q:O),i=function(t,e){return t.filter(function(t){return!M(t,e)})},u=function(e){t.convert(this),this._isActive=n,this._length=0,this._query=e,this._onMutateHandler=this._onMutate.bind(this),this.resume()};return Object.defineProperties(u.prototype,{_onMutate:{value:function(){var t,e,n,r,u=this._query.old(),o=this._query.current();t=i(o,u),e=i(u,o),this._updateArray(o),n=t.length>0,r=e.length>0,(n||r)&&this._bubble(f,o),n&&this._bubble(a,t),r&&this._bubble(l,e)}},_updateArray:{value:function(t){this._deleteArray(),this._length=t.length,t.forEach(function(t,e){this[e]=t},this)}},_deleteArray:{value:function(){Array.prototype.splice.call(this,0),this.length=0}},_bubble:{value:function(t,e){this.emit(t,e)}},forEach:{value:function(){Array.prototype.forEach.apply(this,arguments)}},pause:{value:function(){this._isActive=n,r.off(s,this._onMutateHandler)}},resume:{value:function(){this._isActive||(this._isActive=e,this._updateArray(this._query.current()),r.on(s,this._onMutateHandler))}},length:{get:function(){return this._length}},splice:{value:function(){}}}),u}(),z=function(t){return typeof t===i?new N(y).querySelectorAll(t):new N(t)};return z});